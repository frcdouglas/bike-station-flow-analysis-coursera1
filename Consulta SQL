## Consulta SQL: Principais Rotas do CitiBike em Nova York

Esta consulta identifica as 10 rotas mais populares do sistema CitiBike em Nova York, calculando o número de viagens e a duração média para cada rota, diferenciando por tipo de usuário.

```sql
-- Seleciona o tipo de usuário, a rota e métricas agregadas
SELECT
  usertype,  -- Tipo de usuário (por exemplo, Subscriber ou Customer)
  
  -- Concatena o nome da estação de início com o nome da estação final
  CONCAT(start_station_name, ' to ', end_station_name) AS route,
  
  -- Conta o número total de viagens para essa rota
  COUNT(*) AS num_trips,
  
  -- Calcula a duração média da viagem (em minutos), arredondada para 2 casas decimais
  ROUND(AVG(CAST(tripduration AS INT64) / 60), 2) AS duration

FROM
  `bigquery-public-data.new_york_citibike.citibike_trips`  -- Dataset público no BigQuery

-- Garante que ambas as estações (início e fim) estão preenchidas
WHERE 
  start_station_name != '' AND end_station_name != ''

-- Agrupa por estação de início, estação final e tipo de usuário
GROUP BY
  start_station_name,
  end_station_name,
  usertype

-- Ordena pelo número de viagens em ordem decrescente
ORDER BY
  num_trips DESC

-- Limita o resultado às 10 rotas mais populares
LIMIT 10
